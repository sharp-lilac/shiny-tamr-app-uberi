## caption_functions.R

# Load packages ---------------------------
library(stringr)

# Define caption functions ---------------------------
generate_coral_cover_year_caption <- function(input) {
    selected_localities <- paste(input$coral_cover_year_choose_locality, collapse = ", ")
    selected_years <- paste(input$coral_cover_year_choose_year, collapse = ", ")
    if (input$coral_cover_year_consolidate_year) {
        caption_text <- paste0(
            "Plot of percent coral cover across localities (", selected_localities,
            ") for years ", selected_years, " at Turneffe Atoll. Generated by University of Belize Environmental Research Institute."
        )
    } else {
        caption_text <- paste0(
            "Plot of percent coral cover within localities (", selected_localities,
            ") and across years (", selected_years, ") at Turneffe Atoll. Generated by University of Belize Environmental Research Institute."
        )
    }
    str_wrap(caption_text, width = 200)
}
